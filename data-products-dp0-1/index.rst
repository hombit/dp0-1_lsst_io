.. Review the README on instructions to contribute.
.. Static objects, such as figures, should be stored in the _static directory. Review the _static/README on instructions to contribute.
.. Do not remove the comments that describe each section. They are included to provide guidance to contributors.
.. Do not remove other content provided in the templates, such as a section. Instead, comment out the content and include comments to explain the situation. For example:
	- If a section within the template is not needed, comment out the section title and label reference. Do not delete the expected section title, reference or related comments provided from the template.
    - If a file cannot include a title (surrounded by ampersands (#)), comment out the title from the template and include a comment explaining why this is implemented (in addition to applying the ``title`` directive).

.. This is the label that can be used for cross referencing this file.
.. Recommended title label format is "Directory Name"-"Title Name"  -- Spaces should be replaced by hyphens.
.. _Data-Products-DP0-1-Data-Products:
.. Each section should include a label for cross referencing to a given area.
.. Recommended format for all labels is "Title Name"-"Section Name" -- Spaces should be replaced by hyphens.
.. To reference a label that isn't associated with an reST object such as a title or figure, you must include the link and explicit title using the syntax :ref:`link text <label-name>`.
.. A warning will alert you of identical labels during the linkcheck process.

###################
DP0.1 Data Products
###################

.. This section should provide a brief, top-level description of the page.

.. _DP0-1-Data-Products-Introduction:

The DESC DC2 Data Set
=====================

DP0 is based on the the simulated, LSST-like images generated by the Dark Energy Science Collaboration (DESC) for their Data Challenge 2 (DC2; arXiv:2010.05926). 
DP0 only uses the 300 square degrees of DC2 images that were simulated for five years of the LSST's wide-fast-deep component (WFD; also called the main survey) with a baseline cadence (i.e., a fiducial observing strategy).
For more information about the LSST regions and cadence see `Ivezic et al. (2019) <https://ui.adsabs.harvard.edu/abs/2019ApJ...873..111I/abstract>`_. 

**Simulated Objects and Images:**
The DC2's WFD simulated images include galaxies (with large-scale structure), Type Ia supernovae, and stars (10% of which are variable).
DP0.1 does not include AGN, strong lenses, solar system objects, non-Ia extragalactic transients, or diffuse features (e.g., tidal streams, intracluster light).
The DESC simulated the DC2 images using the `imSim <https://github.com/LSSTDESC/imSim>`__ package.

**Image Processing:**
The DESC processed the simulated DC2 images with `Version 19 <https://pipelines.lsst.io/v/v19_0_0/index.html>`_ of the LSST Science Pipelines.
DP0.1 makes the DESC's DC2 images and catalogs available to RSP users.
For DP0.2, the Rubin Data Production team will reprocess the same images with the most up-to-date version of the LSST Science Pipelines, and release the resulting images and catalogs in mid-2022.

.. toctree::
    :maxdepth: 2
    :glob:

    index-data-processing


.. _DP0-1-Data-Products-DPDD:

DP0.1 Data Products Definition Document (DPDD)
==============================================

**Disclaimer: The DC2 data set is being made available for use on a shared-risk basis.**
**The LSST Science Pipelines which produced these images and catalogs is in active development.**
**The data contents, formats, and related documentation are all incomplete.**

Future data previews and Operations-era data releases will produce images and catalogs that more closely resemble the plan laid out in the Data Products Definitions Document (DPDD; `ls.st/dpdd <https://ls.st/dpdd/>`_).
It is important to note that **many of the future data products listed in the DPDD, and in particular all of the Prompt Products such as difference images and alerts, are not available for DP0.**

.. _DP0-1-Data-Products-DPDD-Images:

Images
------

For DP0.1 the DC2 data set has only two types of images: coadds and processed visit images.

**Processed Visit Images** (PVIs):
A fully-qualified LSST image from a single visit (in other words, a single pointing) that includes the science pixel array and a quality mask and a variance array, in addition to a PSF characterization and metadata (including calibration metadata) about the image.
PVIs are stored with the background already subtracted.
A single CCD of a PVI is called a ``calexp``. 
For more information about how PVI are created see :ref:`Data-Processing-Single-Image-Processing`.

*(MLG: add more information about PVI metadata.)*

*(MLG: point reader to the tutorial which retrieves and displays a PVI/calexp, with metadata for the overlay.)*

**Coadd Images**: 
An image that is the combination of multiple input images, often referred to as just a ``coadd`` or a ``deep coadd``.
The input images have been aligned to a common projection and pixel grid; corrected to the same photometric scale, zero-point, and point-spread function (PSF); and had bad pixels, artifacts, and transient and variable object flux removed prior to combination.
Coadds are stored with the non-astrophysical background already subtracted.
For more information about how PVI are created see :ref:`Data-Processing-Coadded-Image-Processing`.

*(MLG: add more information about coadd metadata.)*

Coadd images are divided into ``tracts`` (a spherical convex polygon) and tracts are diveded into ``patches`` (a quadrilateral sub-region, with a size in pixels chosen to fit easily into memory on desktop computers, about the same size as a ``calexp``).

.. figure:: /_static/dpdd_dc2_zoom.png
    :name: dpdd_dc2_zoom
    
    Figure 15 from `The LSST DESC DC2 Simulated Sky Survey <https://ui.adsabs.harvard.edu/abs/2021ApJS..253...31L/abstract>`_, showing the simulated WFD region divided into tracts. The center image is one tract quadrant, and the right image one hundredth the area of the tract quadrant. Patches are larger than the right image, as described in the DESC's paper: *"each tract is composed of 7x7 patches, and each patch is 4100 Ã— 4100 pixels with a pixel scale of 0.2 arcsec"*. 

The first of the :ref:`Examples-DP0-1-Notebooks` demonstrates how to identify the tract and patch for a given coordinate, and retrieve and plot a coadd image.

*(MLG: point reader to another tutorial which retrieves and displays coadds with metadata for the overlay.)*


.. _DP0-1-Data-Products-DPDD-Catalogs:

Catalogs
--------

Source detection, measurement, and characterization have been run on both the PVIs and coadds to generate catalog data for DP0.1 (see also :ref:`Data-Processing-Coadded-Catalogs`). 

**Schema**:
A table's "schema" refers to the column names, units, and descriptions of the tabulated data.
One way to view and interact with a table's schema is by using the Portal's "table view" function of the TAP service for single-table queries, as described in the :ref:`Data-Access-Analysis-Tools-Portal-Intro`.
The five tables in the "dp01_dc2_catalog" (see below) are all available via the Portal, but the "forced_source" table is not.
All table schema can be viewed and interacted with in a Jupyter Notebook by following the examples in Section 2.2 of the first of the :ref:`Examples-DP0-1-Notebooks`.
Links to full or curated versions of the table schema, the latter of which are limited only to columns that will be of most use to most DP0 delegates, are provided in the table below.

.. list-table:: Tables available for DP0.1
   :widths: 120 120 350
   :header-rows: 1

   * - Table Name
     - Schema Link
     - Description
   * - object
     - Appendix B1 of the `DESC DC2 Release Note <https://ui.adsabs.harvard.edu/abs/2021arXiv210104855L/abstract>`_.
     - The object table from the DESC DC2 simulated sky survey as described in the `DESC DC2 Release Note <https://ui.adsabs.harvard.edu/abs/2021arXiv210104855L/abstract>`_. Includes astrometric and photometric parameters for objects detected in coadded images. (137 columns)
   * - truth_match
     - Appendix B2 of the `DESC DC2 Release Note <https://ui.adsabs.harvard.edu/abs/2021arXiv210104855L/abstract>`_.
     - The truth-match table for the DESC DC2's object table as described in the `DESC DC2 Release Note <https://ui.adsabs.harvard.edu/abs/2021arXiv210104855L/abstract>`_. Includes the noiseless astrometric and photometric parameters and the best matches to the object table. (30 columns)
   * - position
     - full :ref:`Data-Products-DP0-1-schema_position`
     - Select astrometry-related parameters for objects detected in the coadded images, such as coordinates, footprints, patch/tract information, and deblending parameters. (29 columns)
   * - reference
     - curated :ref:`Data-Products-DP0-1-schema_reference`
     - Measurements for objects detected in the coadded images, including photometry, astrometry, shape, deblending, model fits, and related background and flag parameters. This table joined with the position table is very similar to the object table, but with additional columns. (236 columns)
   * - forced_photometry
     - curated :ref:`Data-Products-DP0-1-schema_forced_photometry`
     - Forced photometry measurements for objects detected in the coadded images, at the locations defined by the position table. (747 columns)
   * - fourced_source
     - curated :ref:`Data-Products-DP0-1-schema_forced_source`
     - *(Forced sources in the processed visit images.)* **Only available via the Notebook Aspect**. |

*(MLG: add curated table schema.)*


.. _DP0-1-Data-Products-Visualization:
.. 
.. Visualization
.. =============
..
.. *MLG Note: not sure that this is needed?* 
.. This section includes information about data visualization.
..
..
.. _DP0-1-Data-Products-User-Generated:
.. 
.. User Generated Data Products and Processing
.. ===========================================
.. 
.. *MLG Note: not sure that this is needed?* 
.. This section includes information on user generated data products and user generated data processing.
